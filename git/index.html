
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Introduction to git - Nice R Code</title>
  <meta name="author" content="Rich FitzJohn & Daniel Falster">

  
  <meta name="description" content="Introduction to git 04 April 2013 I’m using “ecologists” as a shorthand here. It’s not an exclusive
term – many geneticists or other scientists will &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://nicercode.github.com/git/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Nice R Code" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39493992-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Nice R Code</a></h1>
  
    <h2>Punning code better since 2013</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:nicercode.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">Introduction to git</h1>
    <p class="meta">








  


<time datetime="2013-04-04T09:00:00+11:00" pubdate data-updated="true">04 April 2013</time></p>
  </header>
  
  <p>I’m using “ecologists” as a shorthand here.  It’s not an exclusive
term – many geneticists or other scientists will do the same thing,
or have the same needs.</p>

<h1 id="hacking-version-control">Hacking version control</h1>

<ul>
  <li>Commented out bits of code / text</li>
  <li>Files with numbers afterwards (<code>thesis_v1.doc</code>, <code>thesis_v2.doc</code>,
<code>thesis_final.doc</code>, <code>thesis_final2.doc</code>, etc)</li>
  <li>Zip up the whole project directory every so often and save it with
the date appended to the filename.</li>
</ul>

<p>Most ecologists seem to invent at least one of these techniques for
doing version control</p>

<p>In addition, you’ll often see people suggesting putting headers like
this in your code file:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">  ## My file (c) Rich FitzJohn
</span><span class="line">  ## Created: 2012/10/04
</span><span class="line">  ## Modified: 2013/04/04</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Sometimes you’ll even see changelogs embedded in these.</p>

<p>The problem with this is that it’s repetitive and boring, it’s
difficult to extract the information easily (e.g., get me all the
files <strong>I</strong> modified in the last month), there is no checking on the
contents of the fields (dates in the future, forgetting to update
dates, inconsistent names, email addresses).  The <em>point</em> of these
headers is nice — keep track of who did what and when, but this is
far easier to do with version control.</p>

<h1 id="why-use-version-control">Why use version control?</h1>

<h2 id="the-fossil-record">The fossil record</h2>

<h2 id="automatic-lab-notebook">Automatic lab notebook</h2>

<h2 id="freeing-yourself-to-delete-things">Freeing yourself to delete things</h2>

<h1 id="workflows">Workflows</h1>

<p>Before starting with git, let’s identify a few workflows that
scientists actually use, then try and map git onto them (rather than
the other way around).  These are workflows that people already do.</p>

<h2 id="the-lone-scientist">1. The lone scientist</h2>

<p>This workflow will seem very familiar to anyone working on a project
where they are the main contributor, especially PhD students.</p>

<h2 id="computer-sync">2. Computer sync</h2>

<p>I have a desktop for doing computing that requires grunt, and a laptop
for cafe work or travel, and I need to keep my projects synchronised.
<a href="http://www.dropbox.com">Dropbox</a> largely solves this problem when you
don’t care about version control, and some people will use it with the
workflow above.</p>

<p>However, this can lead to corruption in your git repository (e.g., if
the network connection is a bit flakey and part of the <code>.git</code>
directory is migrated, changes are made on one copy, then conflicted
copies appear corrupting the repository – and all of its history).</p>

<p>In this workflow, you will usually work on computer A, “push” all your
changes to a server (say, bitbucket or github), then “pull” changes
down to computer B, work on that, and push the changes up onto the
server (rinse and repeat).</p>

<p>This workflow works great, until you do work on both computers in
which case you’ll find yourself doing “Synchronous collaboration”
(below) with yourself.</p>

<h2 id="asynchronous-collaboration">3. Asynchronous collaboration</h2>

<p>This is essentially the model that you do when you do track changes
with your supervisor.  In this workflow, you do some work, then your
collaborator does some work.  You then review their work and apply it
to yours.</p>

<p>A bit of mental gymnastics reveals that this is actually <em>exactly the
same</em> as the workflow above (computer sync).  But now computer B
happens to be owned by somebody else, and you don’t always accept all
their changes.</p>

<p>It also becomes clear that you could possibly both edit the files at
the same time, or that you might have more than one “other” person, in
which case you are again doing “Synchronous collaboration”.</p>

<h2 id="synchronous-collaboration">4. Synchronous collaboration</h2>

<p>In this case here, you have multiple people working on the files at
the same time.  Different people may make changes to different files
at the same time.  It quickly becomes necessary to denote a
“canonical” copy.</p>

<p>Most software projects in the world operate in this way, but this is
not actually that common for ecologists.  This is the jumping off
point for most dicussions on using version control, but we’ll leave it
until later.</p>

<h1 id="learning-git">Learning git</h1>

<p>Git has a reputation for being hard to learn:</p>

<blockquote class="twitter-tweet"><p>They say git gets easier once you get the basic idea that branches are homeomorphic endofunctors mapping submanifolds of a Hilbert space.</p>&mdash; Kornel (@pornelski) <a href="https://twitter.com/pornelski/status/316190292443267073">March 25, 2013</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>One of the things that will make learning git challenging for many
ecologists is that most resources (e.g., the excellent
<a href="http://git-scm.com/book/">git book</a> assume that you are coming from a
background of using CVS, SVN or some other centralised version control
system.  Therefore, they expect you to already be thinking in one way
and then show you how to translate those ideas into git’s ideas.</p>

<p>In a way you’re lucky, as you don’t have to learn a bunch of stuff and
then unlearn it (see
<a href="http://www.reddit.com/r/programming/comments/embdf/git_complicated_of_course_not_commits_map_to/c196s4w">here</a>).
Some of the things that git does just make sense with cheaper
bandwidth and disk space than the systems that were developed in the
past.</p>

<p>For example, git keeps a full copy of the history in <em>every
repository</em>, while CVS and SVN do not.  But if you didn’t know that
different systems did different things, you might easily assume either
is reasonable behaviour (probably the former).  This apparently small
difference then goes on to influence most of the other features of the
systems.</p>

<h1 id="git-basics">Git basics</h1>

<p>We’re going to need some terminology:</p>

<ul>
  <li><strong>Working directory</strong>: This is your copy of a project.  It’s just a
directory with files and other directories in it.</li>
  <li><strong>git directory</strong>: This <em>is</em> the repository; it’s <code>git</code>’s copy of
your files, in its special format.  This is where the history is
kept.</li>
  <li><strong>Staging area</strong>: This is a place for gathering your thoughts as you
begin to mark new versions.</li>
</ul>

<h2 id="interacting-with-git">Interacting with git</h2>

<p>There are a couple of different ways of interacting with git.  The
canonical way is via the command line.  This is different to R’s
command line, and is probably not familiar to most people here.
Anyone who took the software carpentry bootcamp in Febuary 2013 though
will find it familiar.  This allows access to all of git’s features.
If you use git a lot, you’re really going to want to learn this.</p>

<h2 id="setting-up-git-for-command-line-use">Setting up git for command line use</h2>

<p>Obviously, you need git installed.  Check to see you have it installed
by running <code>git --version</code>, which will produce output like this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">~ » git --version
</span><span class="line">git version 1.7.9.6 (Apple Git-31.1)</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>if installed, and an error like this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">~ » git --version
</span><span class="line">bash: git: command not found</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>if not installed.  To install git, just download it from the
<a href="http://git-scm.com">git website</a>.</p>

<p>The first thing is to set your name and email.  These will appear all
over the place, so they are good to set up first.  It feels a bit
weird if you’re the only person using a reposirory, but you only have
to set this once.  So run</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global user.name "Your Name"
</span><span class="line">git config --global user.email your.email@domain.com</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>These are <em>global</em> options and will affect all repositories.  These
can actually be over-ridden on a per-repository basis, but you don’t
generally need to do that.  The configuration options go into the file
<code>~/.gitconfig</code> (the <code>~</code> means “home” in unix commands).</p>

<h3 id="editor">Editor</h3>
<p>The default editor is <a href="http://vim.com"><code>vi</code></a> – if you have used this
before, this will probably be fine, but if not you are in for a rude
shock.  So, next, let’s set that to be a better option.  If you want
to stay on the command line, <code>nano</code> is a nice lightweight choice.</p>

<p>First, check that you have <code>nano</code> installed by typing </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">which nano</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and then running</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global core.editor '/usr/bin/nano'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>(but change the path to reflect where it is installed.  In most
situations it will be <code>/usr/bin/nano</code>).</p>

<p>Whenever git needs you to write a message on a commit, it will pop
open <code>nano</code>.  Write the message and quit with <code>Control-X</code> (<em>X</em> for
<em>exit</em>), answering “Y” when prompted to save the file.</p>

<p>Adding the <code>--tempfile</code> option will cause <code>nano</code> to save on exit
without prompting or asking about the filename.  This can be nice to
avoid being bothered the whole time.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global core.editor '/usr/bin/nano --tempfile'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>However, it removes the ability to easily abort a commit by not saving
the message.</p>

<p>On a Mac, it is possible to use something like “TextEdit” to edit the
file, by running</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global core.editor 'open -t -n -W'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>There is a catch though; you have to make sure that you <strong>quit</strong> the
application after writing your message.  The <code>-n</code> option means that
this is <em>new</em> instance of TextEdit so you won’t lose other open work
when doing this at least.</p>

<h3 id="colour">Colour</h3>

<p>By default, the command line is fairly stark, but git has options to
spruce it up with nice colours.  More than just look pretty, these
allow you to much more easily scan output.</p>

<p>Just run</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global color.ui true</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and the output of <code>status</code> and <code>diff</code> (and a few others) will be
coloured for you.</p>

<h3 id="useful-aliases">Useful aliases</h3>

<p>Git allows you to define aliases for frequently used commands.  So
instead if typing</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git merge --ff-only somebranch</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>you can just type (for example)</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git ff somebranch</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>To set up aliases either use <code>git config</code> again:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">git config --global alias.ff 'merge --ff-only'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Or edit your <code>~/.gitconfig</code> file so it contains a section <code>[alias]</code>
like this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">[alias]
</span><span class="line">        ff   = merge --ff-only</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>My full set of aliases is</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class=""><span class="line">[alias]
</span><span class="line">        lol = log --graph --decorate --pretty=oneline --abbrev-commit
</span><span class="line">        lola = log --graph --decorate --pretty=oneline --abbrev-commit --all
</span><span class="line">        topo = log --graph --simplify-by-decoration --pretty=format:'%d' --all
</span><span class="line">        ff   = merge --ff-only
</span><span class="line">        mrg  = merge --no-ff</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The first (<code>lol</code> = “log one line”) gives a very quick view of the
history of a repository, including its topology.  <code>lola</code> does a
similar thing, but includes remote branches too (and stashes, but
they’re usually hard to interpret).  <code>topo</code> shows just the topology.</p>

<p>The <code>ff</code> alias will merge a commit, but only if a “fast forward”
commit is possible.  Otherwise it will throw an error and I’ll think
about doing a rebase or a merge instead.</p>

<p>The <code>mrg</code> alias will do a merge *even if a fast forward commit is
possible`.  This is sometimes useful for merging in feature branches
when the main branch has not changed.</p>

<h1 id="intermediate-git-branching">Intermediate git: branching</h1>

<p>http://www.sbf5.com/~cduan/technical/git/git-2.shtml</p>

<p>The head:
http://stackoverflow.com/questions/2304087/what-is-git-head-exactly</p>

<p>Nonlinear history:
http://perl.plover.com/classes/git/samples/slide024.html</p>

<p>http://perl.plover.com/classes/git/samples/slide033.html</p>

<h1 id="advanced-stuff">Advanced stuff</h1>

<p>Not everyone agrees what should be done.  Some people eschew rebase
and history rewriting tools:
http://paul.stadig.name/2010/12/thou-shalt-not-lie-git-rebase-ammend.html</p>

<p>While others (including, not surprisingly, git’s author) promote them
http://lwn.net/Articles/328438/</p>

<p>Bear in mind that there are a large number of things that version
control can do for you, and you can’t optimise them all equally.</p>

<p>For example, the first article linked
(http://paul.stadig.name/2010/12/thou-shalt-not-lie-git-rebase-ammend.html)
says that you should not use <code>git merge --squash</code> because that lies by
taking a bunch of commits and joining them together to create some
mega-commit.  At the same time it wants to preserve the ability to run
<code>git bisect</code> on every commit (i.e., code compiles, runs and passes
tests).  In a perfect world this would be fine, because every commit
will work.  But sometimes when doing major reworking, you will break
things.  Sometimes it makes sense to have a feature branch that you
commit to incrementally for your own sanity, tracking your progress
without being too worried about breaking things.  At this point, you
either break <code>git bisect</code> (your code won’t work for some commits) or
you might squash commits (or use more complicated rewriting).  You
can’t satisfy both constraints.  And history rewriting seems like a
much better use of the tools than avoiding making commits in this
case.</p>

<p>These issues have been explained far better elsewhere:
http://darwinweb.net/articles/the-case-for-git-rebase
http://gitguru.com/2009/02/03/rebase-v-merge-in-git/</p>

<p>http://notes.envato.com/developers/rebasing-merge-commits-in-git/</p>

<h1 id="resources">Resources</h1>

<p>Git from the bottom up: internals and gory details
http://ftp.newartisans.com/pub/git.from.bottom.up.pdf</p>

  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013-04-05-why-nice-code/">Why nice code</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013-04-05-projects/">Designing projects</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013-03-08-nice-r-code-2013-plans/">Plans for 'Nice R code module', Macquarie University 2013</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013-02-12-r-ecology-evolution/">R in ecology and evolution</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Rich FitzJohn & Daniel Falster -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'nicercode';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://nicercode.github.com/git/index.html';
        var disqus_url = 'http://nicercode.github.com/git/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
